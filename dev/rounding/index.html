<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Rounding · IntervalArithmetic</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">IntervalArithmetic</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Package</a></li><li><a class="tocitem" href="../intro/">Interval Arithmetic</a></li><li><a class="tocitem" href="../construction/">Constructing intervals</a></li><li><a class="tocitem" href="../usage/">Basic usage</a></li><li><a class="tocitem" href="../decorations/">Decorations</a></li><li><a class="tocitem" href="../multidim/">Multi-dimensional boxes</a></li><li class="is-active"><a class="tocitem" href>Rounding</a><ul class="internal"><li><a class="tocitem" href="#More-detail:-the-internal-representation"><span>More detail: the internal representation</span></a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../input_output/">Input&amp;Output</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Rounding</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Rounding</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaIntervals/IntervalArithmetic.jl/blob/master/docs/src/rounding.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Why-is-rounding-necessary?"><a class="docs-heading-anchor" href="#Why-is-rounding-necessary?">Why is rounding necessary?</a><a id="Why-is-rounding-necessary?-1"></a><a class="docs-heading-anchor-permalink" href="#Why-is-rounding-necessary?" title="Permalink"></a></h1><p>What happens when we write the following Julia code?</p><pre><code class="language-julia-repl hljs">julia&gt; x = 0.1
0.1</code></pre><p>This appears to store the value <code>0.1</code> in a variable <code>x</code> of type <code>Float64</code>. In fact, however, it stores a <em>slightly different</em> number, since <code>0.1</code> <em>cannot be represented exactly in binary floating point arithmetic, at any precision</em>.</p><p>The true value that is actually stored in the variable can be conveniently determined in Julia using arbitrary-precision arithmetic with <code>BigFloat</code>s:</p><pre><code class="language-julia-repl hljs">julia&gt; big(0.1)
0.1000000000000000055511151231257827021181583404541015625</code></pre><p>So, in fact, the Julia float <code>0.1</code> refers to a real number that is slightly greater than 0.1. By default, such calculations are done in round-to-nearest mode (<code>RoundNearest</code>); i.e., the nearest representable floating-point number to 0.1 is used.</p><p>[Recall that to get a <code>BigFloat</code> that is as close as possible to the true 0.1, you can use a special string macro:</p><pre><code class="language-julia-repl hljs">julia&gt; big&quot;0.1&quot;
0.1000000000000000000000000000000000000000000000000000000000000000000000000000002</code></pre><p>]</p><p>Suppose that we create a thin interval, containing just the floating-point number <code>0.1</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; using IntervalArithmetic

julia&gt; II = Interval(0.1)
[0.1, 0.100001]

julia&gt; showfull(II)
Interval(0.1, 0.1)</code></pre><p>It looks like <code>II</code> contains (the true) 0.1, but from the above discussion we see that <em>it does not</em>. In order to contain 0.1, the end-points of the interval must be rounded outwards (&quot;directed rounding&quot;): the lower bound is rounded down, and the upper bound is rounded up.</p><p>This rounding is handled by the <code>@interval</code>  macro, which generates correctly-rounded intervals:</p><pre><code class="language-julia-repl hljs">julia&gt; a = @interval(0.1)
[0.0999999, 0.100001]
</code></pre><p>The true 0.1 is now correctly contained in the intervals, so that any calculations on these intervals will contain the true result of calculating with 0.1. For example, if we define</p><pre><code class="language-julia-repl hljs">julia&gt; f(x) = 2x + 0.2
f (generic function with 1 method)
</code></pre><p>then we can apply the function <code>f</code> to the interval <code>a</code> to obtain</p><pre><code class="language-julia-repl hljs">julia&gt; f(a)
[0.399999, 0.400001]

julia&gt; showfull(f(a))
Interval(0.39999999999999997, 0.4)</code></pre><p>The result correctly contains the true 0.4.</p><h2 id="More-detail:-the-internal-representation"><a class="docs-heading-anchor" href="#More-detail:-the-internal-representation">More detail: the internal representation</a><a id="More-detail:-the-internal-representation-1"></a><a class="docs-heading-anchor-permalink" href="#More-detail:-the-internal-representation" title="Permalink"></a></h2><p>Let&#39;s look at the internal representation of the <code>Float64</code> number 0.1:</p><pre><code class="language-julia-repl hljs">julia&gt; bitstring(0.1)
&quot;0011111110111001100110011001100110011001100110011001100110011010&quot;</code></pre><p>The last 53 bits of these 64 bits correspond to the binary expansion of 0.1, which is</p><pre><code class="nohighlight hljs">0.000110011001100110011001100110011001100...</code></pre><p>We see that the expansion is periodic; in fact, the binary expansion of 0.1 has an infinite repetition of the sequence of digits <code>1100</code>. It is thus <em>impossible</em> to represent the decimal 0.1 in binary, with <em>any</em> precision.</p><p>The true value must be approximated by a floating-point number with fixed precision – this procedure is called <strong>rounding</strong>. For positive numbers, rounding down may be accomplished simply by truncating the expansion; rounding up is accomplished by incrementing the final binary digit and propagating any resulting changes.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../multidim/">« Multi-dimensional boxes</a><a class="docs-footer-nextpage" href="../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 29 August 2023 04:51">Tuesday 29 August 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
